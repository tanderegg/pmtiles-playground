import { WebGLDevice } from "../../adapter/webgl-device.js";
import { setGLParameters } from "../parameters/unified-parameter-api.js";
import { pushContextState, popContextState } from "./track-context-state.js";
export function withGLParameters(device, parameters, func) {
  const webglDevice = WebGLDevice.attach(device);
  const gl = webglDevice.gl;
  if (isObjectEmpty(parameters)) {
    return func(device);
  }
  const {
    nocatch = true
  } = parameters;
  pushContextState(gl);
  setGLParameters(gl, parameters);
  let value;
  if (nocatch) {
    value = func(gl);
    popContextState(gl);
  } else {
    try {
      value = func(gl);
    } finally {
      popContextState(gl);
    }
  }
  return value;
}
function isObjectEmpty(object) {
  for (const key in object) {
    return false;
  }
  return true;
}
//# sourceMappingURL=with-parameters.js.map