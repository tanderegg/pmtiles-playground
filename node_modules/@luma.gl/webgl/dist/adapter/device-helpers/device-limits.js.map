{"version":3,"file":"device-limits.js","names":["getWebGL2Context","getDeviceLimits","gl","gl2","maxTextureDimension1D","maxTextureDimension2D","getParameter","maxTextureDimension3D","maxTextureArrayLayers","maxBindGroups","maxDynamicUniformBuffersPerPipelineLayout","maxDynamicStorageBuffersPerPipelineLayout","maxSampledTexturesPerShaderStage","maxSamplersPerShaderStage","maxStorageBuffersPerShaderStage","maxStorageTexturesPerShaderStage","maxUniformBuffersPerShaderStage","maxUniformBufferBindingSize","maxStorageBufferBindingSize","minUniformBufferOffsetAlignment","minStorageBufferOffsetAlignment","maxVertexBuffers","maxVertexAttributes","maxVertexBufferArrayStride","maxInterStageShaderComponents","maxComputeWorkgroupStorageSize","maxComputeInvocationsPerWorkgroup","maxComputeWorkgroupSizeX","maxComputeWorkgroupSizeY","maxComputeWorkgroupSizeZ","maxComputeWorkgroupsPerDimension","getWebGLLimits","get","pname","get2","defaultValue"],"sources":["../../../src/adapter/device-helpers/device-limits.ts"],"sourcesContent":["// luma.gl, MIT license\n// Copyright (c) vis.gl contributors\n\nimport type {DeviceLimits} from '@luma.gl/core';\nimport {GL} from '@luma.gl/constants';\nimport {getWebGL2Context} from '../../context/context/webgl-checks';\n\n/** Populate a WebGPU style device limits */\nexport function getDeviceLimits(gl: WebGLRenderingContext): DeviceLimits {\n  const gl2: WebGL2RenderingContext | null = getWebGL2Context(gl);\n  return {\n    maxTextureDimension1D: 0, // WebGL does not support 1D textures\n    maxTextureDimension2D: gl.getParameter(GL.MAX_TEXTURE_SIZE),\n    maxTextureDimension3D: gl2 ? gl2.getParameter(GL.MAX_3D_TEXTURE_SIZE) : 0,\n    maxTextureArrayLayers: gl2 ? gl2.getParameter(GL.MAX_ARRAY_TEXTURE_LAYERS) : 0,\n    maxBindGroups: 1, // TBD\n    maxDynamicUniformBuffersPerPipelineLayout: 0, // TBD\n    maxDynamicStorageBuffersPerPipelineLayout: 0, // TBD\n    maxSampledTexturesPerShaderStage: gl.getParameter(GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS), // TBD\n    maxSamplersPerShaderStage: gl.getParameter(GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n    maxStorageBuffersPerShaderStage: 0, // TBD\n    maxStorageTexturesPerShaderStage: 0, // TBD\n    maxUniformBuffersPerShaderStage: gl2 ? gl2.getParameter(GL.MAX_UNIFORM_BUFFER_BINDINGS) : 0,\n    maxUniformBufferBindingSize: gl2 ? gl2.getParameter(GL.MAX_UNIFORM_BLOCK_SIZE) : 0,\n    maxStorageBufferBindingSize: 0,\n    minUniformBufferOffsetAlignment: gl2 ? gl2.getParameter(GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT) : 0,\n    minStorageBufferOffsetAlignment: 0, // TBD\n    maxVertexBuffers: 0,\n    maxVertexAttributes: gl.getParameter(GL.MAX_VERTEX_ATTRIBS),\n    maxVertexBufferArrayStride: 2048, // TBD, this is just the default value from WebGPU\n    maxInterStageShaderComponents: gl2 ? gl2.getParameter(GL.MAX_VARYING_COMPONENTS) : 0,\n    maxComputeWorkgroupStorageSize: 0, // WebGL does not support compute shaders\n    maxComputeInvocationsPerWorkgroup: 0, // WebGL does not support compute shaders\n    maxComputeWorkgroupSizeX: 0, // WebGL does not support compute shaders\n    maxComputeWorkgroupSizeY: 0, // WebGL does not support compute shaders\n    maxComputeWorkgroupSizeZ: 0, // WebGL does not support compute shaders\n    maxComputeWorkgroupsPerDimension: 0, // WebGL does not support compute shaders\n  }\n}\n\n/** WebGL context limits */\nexport type WebGLLimits = {\n  [GL.ALIASED_LINE_WIDTH_RANGE]: [number, number];\n  [GL.ALIASED_POINT_SIZE_RANGE]: [number, number];\n  [GL.MAX_TEXTURE_SIZE]: number;\n  [GL.MAX_CUBE_MAP_TEXTURE_SIZE]: number;\n  [GL.MAX_TEXTURE_IMAGE_UNITS]: number;\n  [GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS]: number;\n  [GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS]: number;\n  [GL.MAX_RENDERBUFFER_SIZE]: number;\n  [GL.MAX_VARYING_VECTORS]: number;\n  [GL.MAX_VERTEX_ATTRIBS]: number;\n  [GL.MAX_VERTEX_UNIFORM_VECTORS]: number;\n  [GL.MAX_FRAGMENT_UNIFORM_VECTORS]: number;\n  [GL.MAX_VIEWPORT_DIMS]: [number, number];\n\n  // Extensions\n  [GL.MAX_TEXTURE_MAX_ANISOTROPY_EXT]: number;\n\n  // WebGL2 Limits\n  [GL.MAX_3D_TEXTURE_SIZE]: number;\n  [GL.MAX_ARRAY_TEXTURE_LAYERS]: number;\n  [GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]: number;\n  [GL.MAX_COLOR_ATTACHMENTS]: number;\n  [GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]: number;\n  [GL.MAX_COMBINED_UNIFORM_BLOCKS]: number;\n  [GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]: number;\n  [GL.MAX_DRAW_BUFFERS]: number;\n  [GL.MAX_ELEMENT_INDEX]: number;\n  [GL.MAX_ELEMENTS_INDICES]: number;\n  [GL.MAX_ELEMENTS_VERTICES]: number;\n  [GL.MAX_FRAGMENT_INPUT_COMPONENTS]: number;\n  [GL.MAX_FRAGMENT_UNIFORM_BLOCKS]: number;\n  [GL.MAX_FRAGMENT_UNIFORM_COMPONENTS]: number;\n  [GL.MAX_SAMPLES]: number;\n  [GL.MAX_SERVER_WAIT_TIMEOUT]: number;\n  [GL.MAX_TEXTURE_LOD_BIAS]: number;\n  [GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]: number;\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]: number;\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]: number;\n  [GL.MAX_UNIFORM_BLOCK_SIZE]: number;\n  [GL.MAX_UNIFORM_BUFFER_BINDINGS]: number;\n  [GL.MAX_VARYING_COMPONENTS]: number;\n  [GL.MAX_VERTEX_OUTPUT_COMPONENTS]: number;\n  [GL.MAX_VERTEX_UNIFORM_BLOCKS]: number;\n  [GL.MAX_VERTEX_UNIFORM_COMPONENTS]: number;\n  [GL.MIN_PROGRAM_TEXEL_OFFSET]: number;\n  [GL.MAX_PROGRAM_TEXEL_OFFSET]: number;\n  [GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT]: number;\n};\n\n\nexport function getWebGLLimits(gl: WebGLRenderingContext): WebGLLimits {\n  const gl2 = getWebGL2Context(gl);\n  function get<T = number>(pname: number): T {\n    return gl.getParameter(pname) as T;\n  }\n  function get2(pname: number, defaultValue?: number): number;\n  function get2<T>(pname: number, defaultValue: T): T;\n  function get2<T>(pname: number, defaultValue: T): T {\n    return gl2 ? gl2.getParameter(pname) as T : (defaultValue || 0) as T;\n  }\n  // function getMaxAnistropy() {\n  //   const extension = gl.getExtension('EXT_texture_filter_anisotropic');\n  // }\n  return {\n    [GL.ALIASED_LINE_WIDTH_RANGE]: get(GL.ALIASED_LINE_WIDTH_RANGE),\n    [GL.ALIASED_POINT_SIZE_RANGE]: get(GL.ALIASED_POINT_SIZE_RANGE),\n    [GL.MAX_TEXTURE_SIZE]: get(GL.MAX_TEXTURE_SIZE),\n    [GL.MAX_CUBE_MAP_TEXTURE_SIZE]: get(GL.MAX_CUBE_MAP_TEXTURE_SIZE), // GLint\n    [GL.MAX_TEXTURE_IMAGE_UNITS]: get(GL.MAX_TEXTURE_IMAGE_UNITS), // GLint\n    [GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS]: get(GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS), // GLint\n    [GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS]: get(GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS), // GLint\n    [GL.MAX_RENDERBUFFER_SIZE]: get(GL.MAX_RENDERBUFFER_SIZE), // GLint\n    [GL.MAX_VARYING_VECTORS]: get(GL.MAX_VARYING_VECTORS), // GLint\n    [GL.MAX_VERTEX_ATTRIBS]: get(GL.MAX_VERTEX_ATTRIBS), // GLint\n    [GL.MAX_VERTEX_UNIFORM_VECTORS]: get(GL.MAX_VERTEX_UNIFORM_VECTORS), // GLint\n    [GL.MAX_FRAGMENT_UNIFORM_VECTORS]: get(GL.MAX_FRAGMENT_UNIFORM_VECTORS), // GLint\n    [GL.MAX_VIEWPORT_DIMS]: get(GL.MAX_VIEWPORT_DIMS),\n\n    // Extensions\n    [GL.MAX_TEXTURE_MAX_ANISOTROPY_EXT]: get(GL.MAX_TEXTURE_MAX_ANISOTROPY_EXT), // getMaxAnistropy(),\n\n    // WebGL2 Limits\n    [GL.MAX_3D_TEXTURE_SIZE]: get2(GL.MAX_3D_TEXTURE_SIZE), //  GLint\n    [GL.MAX_ARRAY_TEXTURE_LAYERS]: get2(GL.MAX_ARRAY_TEXTURE_LAYERS), // GLint\n    [GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]: get2(GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL), //  GLint64\n    [GL.MAX_COLOR_ATTACHMENTS]: get2(GL.MAX_COLOR_ATTACHMENTS), //  GLint\n    [GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]: get2(GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS), // GLint64\n    [GL.MAX_COMBINED_UNIFORM_BLOCKS]: get2(GL.MAX_COMBINED_UNIFORM_BLOCKS), //  GLint\n    [GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]: get2(GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS), // GLint64\n    [GL.MAX_DRAW_BUFFERS]: get2(GL.MAX_DRAW_BUFFERS), // GLint\n    [GL.MAX_ELEMENT_INDEX]: get2(GL.MAX_ELEMENT_INDEX), //  GLint64\n    [GL.MAX_ELEMENTS_INDICES]: get2(GL.MAX_ELEMENTS_INDICES), // GLint\n    [GL.MAX_ELEMENTS_VERTICES]: get2(GL.MAX_ELEMENTS_VERTICES), //  GLint\n    [GL.MAX_FRAGMENT_INPUT_COMPONENTS]: get2(GL.MAX_FRAGMENT_INPUT_COMPONENTS), //  GLint\n    [GL.MAX_FRAGMENT_UNIFORM_BLOCKS]: get2(GL.MAX_FRAGMENT_UNIFORM_BLOCKS), //  GLint\n    [GL.MAX_FRAGMENT_UNIFORM_COMPONENTS]: get2(GL.MAX_FRAGMENT_UNIFORM_COMPONENTS), //  GLint\n    [GL.MAX_SAMPLES]: get2(GL.MAX_SAMPLES), //  GLint\n    [GL.MAX_SERVER_WAIT_TIMEOUT]: get2(GL.MAX_SERVER_WAIT_TIMEOUT), //  GLint64\n    [GL.MAX_TEXTURE_LOD_BIAS]: get2(GL.MAX_TEXTURE_LOD_BIAS), // GLfloat\n    [GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]: get2(GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS), //  GLint\n    [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]: get2(GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS), //  GLint\n    [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]: get2(GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS), // GLint\n    [GL.MAX_UNIFORM_BLOCK_SIZE]: get2(GL.MAX_UNIFORM_BLOCK_SIZE), // GLint64\n    [GL.MAX_UNIFORM_BUFFER_BINDINGS]: get2(GL.MAX_UNIFORM_BUFFER_BINDINGS), //  GLint\n    [GL.MAX_VARYING_COMPONENTS]: get2(GL.MAX_VARYING_COMPONENTS), // GLint\n    [GL.MAX_VERTEX_OUTPUT_COMPONENTS]: get2(GL.MAX_VERTEX_OUTPUT_COMPONENTS), // GLint\n    [GL.MAX_VERTEX_UNIFORM_BLOCKS]: get2(GL.MAX_VERTEX_UNIFORM_BLOCKS), //  GLint\n    [GL.MAX_VERTEX_UNIFORM_COMPONENTS]: get2(GL.MAX_VERTEX_UNIFORM_COMPONENTS), //  GLint\n    [GL.MIN_PROGRAM_TEXEL_OFFSET]: get2(GL.MIN_PROGRAM_TEXEL_OFFSET), // GLint\n    [GL.MAX_PROGRAM_TEXEL_OFFSET]: get2(GL.MAX_PROGRAM_TEXEL_OFFSET), // GLint\n    [GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT]: get2(GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT) // GLint\n  };\n}\n"],"mappings":"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"}